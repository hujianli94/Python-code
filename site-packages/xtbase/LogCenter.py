#coding=utf8
__author__ = '9020win764z'

from pyenv import *
import MysqlHelper
import MySQLdb
import json
import sys

LOG_TYPE_SCRIPT = "script"

LOG_LEVEL_DEBUG = "DEBUG"
LOG_LEVEL_INFO = "INFO"
LOG_LEVEL_WARN = "WARN"
LOG_LEVEL_FATAL = "FATAL"

class LogCenter:
    def __init__(self, processName):
        self.processName = processName
        self.mysql = MysqlHelper.XtMysql()

    def writeLog(self, logType, logLevel, logContent):
        try:
            #准备sql
            sql = "insert into ttlog(typeid, service, content, logLevel, time) values('%s', '%s', '%s', '%s', now())" % (logType, self.processName, logContent, logLevel)
            self.mysql.execQuery(sql)
        except MySQLdb.Error, e:
            print "Error %d: %s" % (e.args[0], e.args[1])

def writeLog(serviceName,logType, logLevel, logContent):
    log = LogCenter(serviceName)
    log.writeLog(logType, logLevel, logContent)

#for test
if  __name__ == "__main__":
    #根据参数数量自测或调用
    if len(sys.argv) < 5:
        print   "usage: %s serviceName logType, logLevel, logContent" %  'LogCenter.py'
    else :
        logType = sys.argv[1]
        logLevel = sys.argv[2]
        logContent = sys.argv[3]
        log = LogCenter(sys.argv[4])
        log.writeLog(logType, logLevel, logContent)
